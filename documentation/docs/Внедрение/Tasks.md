---
sidebar_position: 1
---

# Конфигурация "Tasks"


:::note

Конфигурация с открытым исходным кодом, для управления задачами.  
[Сайт проекта](https://github.com/BlizD/Tasks)

:::

## Определяемые типы

Необходимо установить типы для:
- `канбан_Задачи` - справочник с задачами **СправочникСсылка.узЗадачи**
- `канбан_Пользователь` - справочник Пользователи (БСП) **СправочникСсылка.Пользователи**
- `канбан_Проекты` - справочник проектов **СправочникСсылка.узПроекты**
- `канбан_СтатусыЗадач` - справочник статусов задач **СправочникСсылка.узСтатусыЗадачи**

## Переопределяемые модули

:::info

Расширение содержит готовый код переопределяемых методов для текущей конфигурации

:::

### ОМ канбан_КанбанДоскаПереопределяемый

#### ТекстЗапросаДанныеЗадач()

Необходимо указать основной текст запроса разрешенных задач для получения слудующих полей:

* Задача - ОпределяемыйТип.канбан_Задачи - ссылка на задачу
* КодЗадачи - Число, Строка - код задачи
* СтатусЗадачи - ОпределяемыйТип.канбан_СтатусыЗадач
* ХранилищеФотографии - ХранилищеЗначения - фотография исполнителя задачи.
* НаименованиеЗадачи - Строка - наименование задачи
* Проект - ОпределяемыйТип.канбан_Проекты
* Исполнитель - ОпределяемыйТип.канбан_Пользователь

Возвращаемое значение: Строка

```bsl title="ТекстЗапросаДанныеЗадач"
Запрос = Новый Запрос;
Запрос.Текст =
    "ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	узЗадачи.Ссылка КАК Задача,
    |	узЗадачи.Код КАК КодЗадачи,
    |	узЗадачи.Статус КАК СтатусЗадачи,
    |	ЕСТЬNULL(Пользователи.Фотография, """") КАК ХранилищеФотографии,
    |	узЗадачи.Наименование КАК НаименованиеЗадачи,
    |	ЕСТЬNULL(узЗадачиОсновные.Проект, узЗадачи.Проект) КАК Проект,
    |	узЗадачи.Исполнитель КАК Исполнитель
    |ИЗ
    |	Справочник.узЗадачи КАК узЗадачи
    |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Пользователи КАК Пользователи
    |		ПО узЗадачи.Исполнитель = Пользователи.Ссылка
    |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.узЗадачи КАК узЗадачиОсновные
    |		ПО узЗадачи.ОсновнаяЗадача = узЗадачиОсновные.Ссылка
    |ГДЕ
    |	узЗадачи.ПоказыватьВОтчетахИКанбанДоске";
	
Возврат Запрос.Текст;
```

#### ТекстЗапросаСтатусы()

Необходимо указать текст запроса разрешенных статусов для получения следующих полей:

* Статус - ОпределяемыйТип.канбан_СтатусыЗадач
* Представление - Строка - представление статуса для канбан доски
* УникальныйИдентификатор - Строка

 Возвращаемое значение: Строка

```bsl title="ТекстЗапросаСтатусы"
Запрос = Новый Запрос;
Запрос.Текст =
    "ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	узСтатусыЗадачи.Ссылка КАК Статус,
    |	ВЫБОР
    |		КОГДА узСтатусыЗадачи.НаименованиеДляКанбанДоски = """"
    |			ТОГДА узСтатусыЗадачи.Наименование
    |		ИНАЧЕ узСтатусыЗадачи.НаименованиеДляКанбанДоски
    |	КОНЕЦ КАК Представление,
    |	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(узСтатусыЗадачи.Ссылка) КАК УникальныйИдентификатор
    |ИЗ
    |	Справочник.узСтатусыЗадачи КАК узСтатусыЗадачи";

Возврат Запрос.Текст;
```

#### ИзменитьСтатусЗадаче(Задача, Статус, Отказ)

Принимаемые параметры:
 * Задача - ОпределяемыйТип.канбан_Задачи
 * Статус - ОпределяемыйТип.канбан_СтатусыЗадач - устанавливаемый статус
 * Отказ  - Булево

Метод должен изменить статус для указанной задачи.

```bsl title="ИзменитьСтатусЗадаче"
Попытка
    
    ЗадачаОбъект = Задача.ПолучитьОбъект();
    
    ЗадачаОбъект.Заблокировать();
    
    ЗадачаОбъект.Статус = Статус;
    
    ЗадачаОбъект.Записать();
    
Исключение
    
    Отказ = Истина;
    
    ЗаписьЖурналаРегистрации(
        "ТипОперации", 
        УровеньЖурналаРегистрации.Ошибка,, 
        "Текст", 
        ОбработкаОшибок.ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
        
    ВызватьИсключение;
    
КонецПопытки;
```

### ОМ канбан_КанбанДоскаКлиентПереопределяемый

#### СобытияОбработкиОповещения(События)

Принимаемые параметры:
 * События - Массив из Строка

В методе можно дополнить список событий обработки оповещения при которых нужно обновить доску.

```bsl title="СобытияОбработкиОповещения"
События.добавить("СправочникЗадачаЗаписана");
```